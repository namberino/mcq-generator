[page 17] **AI VIETNAM** **aivietnam.edu.vn**


12 `plt.ylabel(’Loan` `Amount (Thousands) ’)`

13 `plt.show ()`


Listing 3: Chọn biến và trực quan hóa dữliệu


**3** **Bước 3: Chọn sốcụm và khởi tạo centroids**


Bước 1 và 2 của K-Means là vềviệc chọn sốlượng cụm (k) và chọn các centroids ngẫu nhiên cho mỗi
cụm. Chúng ta sẽchọn 3 cụm và sau đó chọn các quan sát ngẫu nhiên từdữliệu làm centroids:


1 `# Step 1 and 2 - Choose the number of clusters (k) and` `randomly` `select` `centroids` `for`

```
    each cluster

```

2


3 `# number of clusters`


4 `K = 3`


5


6 `# Randomly` `select` `observations as centroids`

7 `Centroids = X.sample(n=K)`

8 `plt.scatter(X[" ApplicantIncome "], X[" LoanAmount "], c=’black ’)`

9 `plt.scatter(Centroids [" ApplicantIncome "], Centroids [" LoanAmount "], c=’red ’)`

10 `plt.xlabel(’Annual Income ’)`

11 `plt.ylabel(’Loan` `Amount (Thousands) ’)`


Listing 4: Chọn sốcụm và khởi tạo centroids


Ởđây, các chấm đỏđại diện cho 3 centroids của mỗi cụm. Lưu ý rằng chúng ta đã chọn những điểm
này một cách ngẫu nhiên, và do đó mỗi lần bạn chạy mã này, bạn có thểnhận được các centroids khác
nhau.


16

[page 18] ính**


Tiếp theo, chúng ta sẽđịnh nghĩa một sốđiều kiện đểtriển khai thuật toán K-Means Clustering. Hãy

xem mã trước:


1 `# Step 3 - Assign all points to the` `nearest` `cluster` `centroid`

2 `# Step 4 - Recalculate` `the` `centroids of the newly` `formed` `clusters`

3 `# Step 5 - Repeat` `steps 3 and 4`


4


5 `diff = 1`


6 `j = 0`


7


8 `while` `diff != 0:`


9 `XD = X.copy ()`


10 `i = 1`


11 `for index1, row_c in Centroids.iterrows ():`


12 `ED = []`


13 `for index2, row_d in XD.iterrows ():`

14 `d1 = (row_c [" ApplicantIncome "] - row_d [" ApplicantIncome "]) **2`

15 `d2 = (row_c [" LoanAmount "] - row_d [" LoanAmount "]) **2`

16 `d = np.sqrt(d1 + d2)`

17 `ED.append(d)`

18 `X[i] = ED`


19 `i += 1`


20


21 `C = []`


22 `for index, row in X.iterrows ():`

23 `min_dist = row [1]`


24 `pos = 1`

25 `for i in range(K):`

26 `if row[i + 1] < min_dist:`


27 `min_dist = row[i + 1]`


28 `pos = i + 1`

29 `C.append(pos)`

30 `X[" Cluster "] = C`

31 `Centroids_new = X.groupby ([" Cluster "]).mean ()[[" LoanAmount", " ApplicantIncome "]]`


32


33 `if j == 0:`


34 `diff = 1`


35 `j += 1`


36 `else:`


37 `diff = (Centroids_new[’LoanAmount ’] - Centroids[’Loan

[page 6] **AI VIETNAM** **aivietnam.edu.vn**


    - **Bước cập nhật centroid (Update Step):** Tính lại vịtrí centroid cho mỗi cụm _j_ dựa trên
trung bình các điểm thuộc cụm:



1
_c_ [(] _[t]_ [+1)] =
_j_

_|S_ _j_ [(] _[t]_ [)] _[|]_



�

_x∈S_ [(] _[t]_ [)]
_j_



_x_



Hình 3: Cập nhật centroids


    - **Cập nhật biến** `converged` dựa trên sựthay đổi của centroid. Nếu các centroid không thay
đổi hoặc thay đổi rất nhỏ, đặt `converged` = `true` .

```
            Repeat_step.png

```

Hình 4: Quay lại bước 5


Kết thúc khi thuật toán hội tụhoặc đạt sốlần lặp tối đa, trảvềcentroid và nhãn cụm của các điểm
dữliệu.


5

[page 16] **AI VIETNAM** **aivietnam.edu.vn**

## **Phần II: Triển khai Thuật toán K-Means từđầu trong Python**


Bây giờlà lúc khởi động Jupyter notebooks (hoặc IDE nào bạn sửdụng) và bắt tay vào làm việc với
Python! Chúng ta sẽlàm việc với bộdữliệu dựđoán vay vốn mà bạn có thểtải xuống. Tôi khuyến khích
bạn đọc thêm vềbộdữliệu và bài toán dựđoán vay vốn. Điều này sẽgiúp bạn hình dung những gì
chúng ta đang làm (và tại sao chúng ta làm điều này). Đây là hai câu hỏi khá quan trọng trong bất kỳ
dựán khoa học dữliệu nào. **1** **Bước 1: Import các thư viện cần thiết**


Đầu tiên, import tất cảcác thư viện cần thiết:


1 `import` `pandas as pd`

2 `import` `numpy as np`

3 `import` `random as rd`

4 `import` `matplotlib.pyplot as plt`


Listing 1: Import các thư viện


**2** **Bước 2: Đọc và khám phá dữliệu**


Bây giờ, chúng ta sẽđọc file CSV và xem năm hàng đầu tiên của dữliệu:


1 `data = pd.read_csv(’clustering.csv ’)`

2 `data.head ()`


Listing 2: Đọc dữliệu


Hình 5: Đọc file


Đối với bài viết này, chúng ta sẽchỉlấy hai biến từdữliệu - "LoanAmount"và "ApplicantIncome". Điều này sẽgiúp dễdàng hình dung các bước cũng như thực hiện.

[page 11] 

Lặp lại quá trình assignment và update cho đến khi centroids không thay đổi hoặc thay đổi rất nhỏ. Kết quảcuối cùng:


  **Nhóm Trẻ(Cụm 0):** (18,80), (20,90), (22,85)


  **Nhóm Trung niên (Cụm 2):** (30,50), (34,64), (40,60)


  **Nhóm Cao tuổi (Cụm 1):** (60,30), (66,40), (70,25)


10