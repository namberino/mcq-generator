['[page 12] s = calculate_wcss(X, labels, kmeans.centroids)`\n\n11 `print` `(f` `"WCSS: {wcss}"` `)`\n\n\n11', '[page 14] ext.fit(bow_matrix.toarray ())`\n\n24 `print` `(` `"Text` `clustering` `labels:"` `, labels)`\n\n## **4. Các kỹthuật nâng cao**\n\n\n**1** **Lựa chọn K tối ưu - Elbow Method**\n\n\n1 `def` `elbow_method(X, max_k =10):`\n\n2 `wcss_values = []`\n\n3 `k_range = range` `(1, max_k + 1)`\n\n\n4\n\n\n5 `for k in k_range:`\n\n6 `kmeans = KMeans(k=k)`\n\n\n7 `labels = kmeans.fit(X)`\n\n\n8 `wcss = calculate_wcss(X, labels, kmeans.centroids)`\n\n9 `wcss_values.append(wcss)`\n\n\n10\n\n\n11 `# Plot the Elbow` `graph`\n\n12 `plt.figure(figsize =(10, 6))`\n\n13 `plt.plot(k_range, wcss_values, ’bo -’)`\n\n14 `plt.xlabel(` `’Number of clusters (k)’)`\n\n15 `plt.ylabel(` `’WCSS ’)`\n\n16 `plt.title(` `’Elbow` `Method to select` `optimal k’)`\n\n17 `plt.grid(True)`\n\n18 `plt.show ()`\n\n\n19\n\n\n20 `return` `wcss_values`\n\n\n21\n\n\n22 `# Use the Elbow` `Method`\n\n\n23 `wcss_values = elbow_method(X, max_k =8)`\n\n\n**2** **K-Means++ Initialization**\n\n\nCải thiện việc khởi tạo centroids đểtránh local minima:\n\n\n1 `def` `kmeans_plus_plus_init (X, k):`\n\n2 `centroids = []`\n\n\n3\n\n\n4 `# Randomly` `select the first` `centroid`\n\n5 `centroids.append(X[np.random.randint(X.shape [0]) ])`\n\n\n6\n\n\n7 `for _ in range` `(1, k):`\n\n8 `# Calculate` `distance to the` `nearest` `centroi', '[page 18] Amount ’]).sum() + (`\n```\n    Centroids_new[’ApplicantIncome ’] - Centroids[’ApplicantIncome ’]).sum()\n```\n\n38 `print(diff.sum())`\n\n\n39\n\n\n40 `Centroids = Centroids_new`\n\n\nListing 5: Triển khai thuật toán K-Means\n\n\nNhững giá trịnày có thểthay đổi mỗi lần chúng ta chạy.']